<div class="mt-5" style="overflow-x: auto;">
    <div class="figure1-plot-container" id="project_1_figure_3_container">
        <div id="figure_3_legend"></div>
        <figure style="margin-left: 80px;">
            <svg id="project_1_figure_3"></svg>
        </figure>
    </div>
</div>
<figcaption class="figure-caption" style="text-align: center;">
    Figure 3: Temporal trend of individual, national and global CO2 storage rate annual average growth.
</figcaption>

<template id="figure_3_legend-grp-template">
    <div class="figure_3_legend-grp">
        <b>
            <div class="figure_3_legend-grp-header" style="font-size: 10px; color: white"></div>
        </b>
        <div class="figure_3_legend-grp-content"></div>
    </div>
</template>

<template id="figure_3_legend-btn-template">
    <div>
        <div class="figure_3_legend-btn" style="font-size: 10px;">
            <span class="figure_3_legend-color"></span>
            <span class="figure_3_legend-text"></span>
        </div>
    </div>
</template>

<script type="module">

    // Sample Data
    const figure3Data = [{ "year": "1996", "facility_0": 0.07, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 0.0, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "1997", "facility_0": 0.665, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 0.0, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "1998", "facility_0": 0.842, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 0.0, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "1999", "facility_0": 0.971, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 0.0, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2000", "facility_0": 0.933, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 1.55, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2001", "facility_0": 1.009, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 1.55, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2002", "facility_0": 0.955, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 1.55, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2003", "facility_0": 0.914, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 1.55, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2004", "facility_0": 0.75, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 1.55, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2005", "facility_0": 0.858, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 1.55, "facility_9": 0.0, "facility_10": 0.0, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2006", "facility_0": 0.82, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 1.55, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2007", "facility_0": 0.921, "facility_1": 0.0, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.0, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 1.55, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 0.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2008", "facility_0": 0.814, "facility_1": 0.197, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.3625, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 1.55, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 4.4, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2009", "facility_0": 0.86, "facility_1": 0.308, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.3625, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 2.67, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 4.6, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2010", "facility_0": 0.743, "facility_1": 0.46, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.3625, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 2.67, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 4.8, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2011", "facility_0": 0.929, "facility_1": 0.403, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.3625, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 2.67, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.1, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.034, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 5.0, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2012", "facility_0": 0.842, "facility_1": 0.49, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.3625, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 0.0, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.0, "facility_12": 0.0, "facility_13": 0.1, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.326, "facility_21": 0.0, "facility_22": 0.0, "facility_23": 4.8, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2013", "facility_0": 0.702, "facility_1": 0.469, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.3625, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 0.0, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.05, "facility_12": 0.0, "facility_13": 0.1, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.334, "facility_21": 0.75, "facility_22": 0.0, "facility_23": 5.9, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.092 }, { "year": "2014", "facility_0": 0.658, "facility_1": 0.587, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.3625, "facility_5": 0.0, "facility_6": 0.0, "facility_7": 0.0, "facility_8": 2.127, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.05, "facility_12": 0.0, "facility_13": 0.1, "facility_14": 0.0, "facility_15": 0.0, "facility_16": 0.0, "facility_17": 0.0, "facility_18": 0.0, "facility_19": 0.0, "facility_20": 0.301, "facility_21": 0.75, "facility_22": 0.0, "facility_23": 6.9, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.092 }, { "year": "2015", "facility_0": 0.707, "facility_1": 0.679, "facility_2": 0.0, "facility_3": 0.0, "facility_4": 0.3625, "facility_5": 0.0, "facility_6": 0.371, "facility_7": 0.036, "facility_8": 2.07794, "facility_9": 0.0, "facility_10": 0.27, "facility_11": 0.05, "facility_12": 0.0, "facility_13": 0.1, "facility_14": 0.0, "facility_15": 0.1, "facility_16": 0.94, "facility_17": 0.0, "facility_18": 0.114, "facility_19": 0.0, "facility_20": 0.0, "facility_21": 0.75, "facility_22": 0.0, "facility_23": 6.9, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.092 }, { "year": "2016", "facility_0": 0.632, "facility_1": 0.75, "facility_2": 0.8, "facility_3": 0.0, "facility_4": 1.6, "facility_5": 0.0, "facility_6": 1.11, "facility_7": 0.1, "facility_8": 1.972025, "facility_9": 0.3, "facility_10": 0.0, "facility_11": 0.05, "facility_12": 0.0, "facility_13": 0.1, "facility_14": 0.0, "facility_15": 0.1, "facility_16": 2.0, "facility_17": 0.0, "facility_18": 0.114, "facility_19": 3.09, "facility_20": 0.0, "facility_21": 0.75, "facility_22": 0.0, "facility_23": 6.3, "facility_24": 0.0, "facility_25": 0.0, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 0.0, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.092 }, { "year": "2017", "facility_0": 0.557, "facility_1": 0.68, "facility_2": 0.8, "facility_3": 0.0, "facility_4": 2.5, "facility_5": 0.0, "facility_6": 1.138, "facility_7": 0.142, "facility_8": 1.79364, "facility_9": 0.19, "facility_10": 0.0, "facility_11": 0.05, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.1, "facility_16": 1.1, "facility_17": 0.0, "facility_18": 0.114, "facility_19": 5.45, "facility_20": 0.507, "facility_21": 1.16, "facility_22": 0.0, "facility_23": 6.6, "facility_24": 0.0, "facility_25": 0.506649, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 2.071626, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.092 }, { "year": "2018", "facility_0": 0.509, "facility_1": 0.758, "facility_2": 0.8, "facility_3": 0.0, "facility_4": 2.8, "facility_5": 0.0, "facility_6": 1.066, "facility_7": 0.18, "facility_8": 1.973197, "facility_9": 0.24, "facility_10": 0.0, "facility_11": 0.05, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.1, "facility_16": 1.385, "facility_17": 0.0, "facility_18": 0.114, "facility_19": 6.4, "facility_20": 0.525, "facility_21": 1.16, "facility_22": 0.309858, "facility_23": 0.427087, "facility_24": 0.0, "facility_25": 0.525001, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 2.910161, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.13193 }, { "year": "2019", "facility_0": 0.482, "facility_1": 0.721, "facility_2": 0.8, "facility_3": 2.707, "facility_4": 4.6, "facility_5": 0.0, "facility_6": 1.128, "facility_7": 0.27, "facility_8": 1.993, "facility_9": 0.23, "facility_10": 0.0, "facility_11": 0.05, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.1, "facility_16": 1.5, "facility_17": 0.56, "facility_18": 0.114, "facility_19": 7.05, "facility_20": 0.52, "facility_21": 1.16, "facility_22": 0.382859, "facility_23": 0.376409, "facility_24": 0.0, "facility_25": 0.519779, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 3.661626, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2020", "facility_0": 0.506, "facility_1": 0.422, "facility_2": 0.8, "facility_3": 2.1706, "facility_4": 7.0, "facility_5": 0.933, "facility_6": 0.941, "facility_7": 0.37, "facility_8": 1.772, "facility_9": 0.298, "facility_10": 0.0, "facility_11": 0.05, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.1, "facility_16": 1.9, "facility_17": 0.63, "facility_18": 0.114, "facility_19": 4.95, "facility_20": 0.51978, "facility_21": 0.660309, "facility_22": 0.21315, "facility_23": 0.418418, "facility_24": 0.0, "facility_25": 0.521581, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 2.138919, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.0, "facility_37": 0.0 }, { "year": "2021", "facility_0": 0.322, "facility_1": 0.0, "facility_2": 0.8, "facility_3": 1.656, "facility_4": 8.7, "facility_5": 1.24, "facility_6": 1.055, "facility_7": 0.45, "facility_8": 1.922, "facility_9": 0.3076, "facility_10": 0.0, "facility_11": 0.05, "facility_12": 0.0, "facility_13": 0.0, "facility_14": 0.0, "facility_15": 0.1, "facility_16": 2.0, "facility_17": 0.62, "facility_18": 0.114, "facility_19": 2.61, "facility_20": 0.443928, "facility_21": 0.714124, "facility_22": 0.232994, "facility_23": 0.424816, "facility_24": 0.0, "facility_25": 0.519779, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.0, "facility_29": 0.0, "facility_30": 1.706149, "facility_31": 0.0, "facility_32": 0.0, "facility_33": 0.0, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.815505, "facility_37": 0.0 }, { "year": "2022", "facility_0": 0.115, "facility_1": 0.402, "facility_2": 0.8, "facility_3": 1.72, "facility_4": 10.6, "facility_5": 1.034, "facility_6": 0.971, "facility_7": 0.5, "facility_8": 0.0, "facility_9": 0.657, "facility_10": 0.0, "facility_11": 0.05, "facility_12": 0.001, "facility_13": 0.0, "facility_14": 0.001, "facility_15": 0.1, "facility_16": 2.77, "facility_17": 0.59, "facility_18": 0.316, "facility_19": 3.0, "facility_20": 0.42858, "facility_21": 0.65243, "facility_22": 0.311307, "facility_23": 0.395332, "facility_24": 0.012, "facility_25": 0.42858, "facility_26": 0.0, "facility_27": 0.0, "facility_28": 0.076658, "facility_29": 0.0, "facility_30": 2.189392, "facility_31": 0.0, "facility_32": 0.081963, "facility_33": 0.023775, "facility_34": 0.0, "facility_35": 0.0, "facility_36": 0.768681, "facility_37": 0.092201 }, { "year": "2023", "facility_0": 0.0, "facility_1": 0.0, "facility_2": 0.8, "facility_3": 1.5943, "facility_4": 13.0, "facility_5": 1.477649, "facility_6": 1.003, "facility_7": 0.0, "facility_8": 0.0, "facility_9": 0.472, "facility_10": 0.0, "facility_11": 0.05, "facility_12": 0.001, "facility_13": 0.0, "facility_14": 0.001, "facility_15": 0.1, "facility_16": 1.59, "facility_17": 0.68, "facility_18": 0.0, "facility_19": 3.67, "facility_20": 0.543979, "facility_21": 0.6313768, "facility_22": 0.260586, "facility_23": 0.43508, "facility_24": 0.01, "facility_25": 0.543978, "facility_26": 0.008, "facility_27": 0.03, "facility_28": 0.0095305, "facility_29": 0.033759, "facility_30": 5.198001, "facility_31": 0.36, "facility_32": 0.165834, "facility_33": 0.02236, "facility_34": 0.032576, "facility_35": 3.932897, "facility_36": 0.736405, "facility_37": 0.07 }];
    const figure3Meta = { "facility_0": { "name": "Sleipner ", "color": "rgb(189189189)", "country": "Norway", "solid": [[1996, 2024]], "dashed": [] }, "facility_1": { "name": "Snohvit ", "color": "rgb(99,99,99)", "country": "Norway", "solid": [[1996, 2024]], "dashed": [] }, "facility_2": { "name": "ADNOC Al Reyadah", "color": "rgb(194,230,153)", "country": "United Arab Emirates", "solid": [[1996, 2016], [2023, 2024]], "dashed": [[2016, 2023]] }, "facility_3": { "name": "Chevron Gorgon", "color": "rgb(44,127,184)", "country": "Australia", "solid": [[1996, 2024]], "dashed": [] }, "facility_4": { "name": "Petrobras Santos Basin Pre-Salt Oil Field", "color": "rgb(161,217,155)", "country": "Brazil", "solid": [[1996, 2008], [2015, 2024]], "dashed": [[2008, 2015]] }, "facility_5": { "name": "Alberta Carbon Trunk Line (ACTL) ", "color": "rgb(242,240,247)", "country": "Canada", "solid": [[1996, 2024]], "dashed": [] }, "facility_6": { "name": "Quest ", "color": "rgb(203,201,226)", "country": "Canada", "solid": [[1996, 2024]], "dashed": [] }, "facility_7": { "name": "Aquistore", "color": "rgb(158,154,200)", "country": "Canada", "solid": [[1996, 2024]], "dashed": [] }, "facility_8": { "name": "Weyburn-Midale", "color": "rgb(106,81,163)", "country": "Canada", "solid": [[1996, 2000], [2011, 2024]], "dashed": [[2000, 2011]] }, "facility_9": { "name": "ShengLi  Oilfield", "color": "rgb(255,245,240)", "country": "China", "solid": [[1996, 2024]], "dashed": [] }, "facility_10": { "name": "Zhongyuan Oilfield", "color": "rgb(254,224,210)", "country": "China", "solid": [[1996, 2006], [2015, 2024]], "dashed": [[2006, 2015]] }, "facility_11": { "name": "Yanchang Integrated Demonstration", "color": "rgb(252,187,161)", "country": "China", "solid": [[1996, 2013], [2023, 2024]], "dashed": [[2013, 2023]] }, "facility_12": { "name": "ShanDong ZouCheng Plant", "color": "rgb(252,146,114)", "country": "China", "solid": [[1996, 2022], [2023, 2024]], "dashed": [[2022, 2023]] }, "facility_13": { "name": "Xinjiang Ordos Basin", "color": "rgb(251,106,74)", "country": "China", "solid": [[1996, 2012], [2016, 2024]], "dashed": [[2012, 2016]] }, "facility_14": { "name": "ShanXi Datong CO2 Sequestration Project ", "color": "rgb(239,59,44)", "country": "China", "solid": [[1996, 2022], [2023, 2024]], "dashed": [[2022, 2023]] }, "facility_15": { "name": "Karamay Dunhua", "color": "rgb(203,24,29)", "country": "China", "solid": [[1996, 2015], [2023, 2024]], "dashed": [[2015, 2023]] }, "facility_16": { "name": "Jilin Oilfield", "color": "rgb(153,0,13)", "country": "China", "solid": [[1996, 2024]], "dashed": [] }, "facility_17": { "name": "Qatar LNG", "color": "rgb(254,153,41)", "country": "Qatar", "solid": [[1996, 2024]], "dashed": [] }, "facility_18": { "name": "Uthmaniyah Carbon Dioxide Enhanced Oil Recovery (CO2-EOR) Demonstration Project", "color": "rgb(204,76,2)", "country": "Saudi Arabia", "solid": [[1996, 2015], [2021, 2024]], "dashed": [[2015, 2021]] }, "facility_19": { "name": "Denver Unit / Wasson San Andres Field", "color": "rgb(247,244,249)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_20": { "name": "Illinois Inustrial CCS ", "color": "rgb(231,225,239)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_21": { "name": "North Burbank Unit", "color": "rgb(212,185,218)", "country": "USA", "solid": [[1996, 2013], [2019, 2024]], "dashed": [[2013, 2019]] }, "facility_22": { "name": "Core Energy  Otsego County EOR Operations", "color": "rgb(201,148,199)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_23": { "name": "Shute Creek", "color": "rgb(223,101,176)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_24": { "name": "30-30 Gas Plant", "color": "rgb(231,41,138)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_25": { "name": "Illinois Industrial Carbon Capture and Sequestration Project", "color": "rgb(206,18,86)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_26": { "name": "Barnett RDC Well No. 1", "color": "rgb(152,0,67)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_27": { "name": "Blue Flint CO2 Storage Project", "color": "rgb(103,0,31)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_28": { "name": "Campo Viejo Gas Processing Plant", "color": "rgb(255,247,243)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_29": { "name": "Camrick Unit", "color": "rgb(253,224,221)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_30": { "name": "Hobbs Field", "color": "rgb(252,197,192)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_31": { "name": "Petra Nova West Ranch", "color": "rgb(250,159,181)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_32": { "name": "Red Trail Energy, LLC", "color": "rgb(247,104,161)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_33": { "name": "Red Hills Gas Processing Plant", "color": "rgb(221,52,151)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_34": { "name": "Seminole East Field (SEF)", "color": "rgb(174,1,126)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_35": { "name": "Seminole San Andres Unit", "color": "rgb(122,1,119)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_36": { "name": "West Seminole San Andres Unit", "color": "rgb(73,0,106)", "country": "USA", "solid": [[1996, 2024]], "dashed": [] }, "facility_37": { "name": "Farnsworth Unit CO2 Flood", "color": "rgb(129,15,124)", "country": "USA", "solid": [[1996, 2013], [2018, 2024]], "dashed": [[2013, 2018]] } }
    const figure3Keys = ['facility_0', 'facility_1', 'facility_2', 'facility_3',
        'facility_4', 'facility_5', 'facility_6', 'facility_7', 'facility_8',
        'facility_9', 'facility_10', 'facility_11', 'facility_12',
        'facility_13', 'facility_14', 'facility_15', 'facility_16',
        'facility_17', 'facility_18', 'facility_19', 'facility_20',
        'facility_21', 'facility_22', 'facility_23', 'facility_24',
        'facility_25', 'facility_26', 'facility_27', 'facility_28',
        'facility_29', 'facility_30', 'facility_31', 'facility_32',
        'facility_33', 'facility_34', 'facility_35', 'facility_36',
        'facility_37'];
    const categories = [
        { 'id': 0, 'name': 'Norway', 'color': 'rgb(189,189,189)' },
        { 'id': 1, 'name': 'United Arab Emirates', 'color': 'rgb(194,230,153)' },
        { 'id': 2, 'name': 'Australia', 'color': 'rgb(44,127,184)' },
        { 'id': 3, 'name': 'Brazil', 'color': 'rgb(161,217,155)' },
        { 'id': 4, 'name': 'Canada', 'color': 'rgb(106,81,163)' },
        { 'id': 5, 'name': 'China', 'color': 'rgb(239,59,44)' },
        { 'id': 6, 'name': 'Qatar', 'color': 'rgb(254,153,41)' },
        { 'id': 7, 'name': 'Saudi Arabia', 'color': 'rgb(204,76,2)' },
        { 'id': 8, 'name': 'USA', 'color': 'rgb(206,18,86)' }
    ];

    let data = figure3Data;
    let keys = figure3Keys;

    const plot = () => {
        const margin = { top: 20, right: 30, bottom: 30, left: 40 },
            width = 1000 - margin.left - margin.right,
            height = 800 - margin.top - margin.bottom;
        let svg = d3.select("#project_1_figure_3")
        svg.selectAll("*").remove();

        svg.attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
            .append("g")
            .attr("transform", `translate(${margin.left},${margin.top})`);

        const stack = d3.stack().keys(keys);
        const stackedData = stack(data);

        // Scales
        const x = d3.scaleLinear()
            .domain(d3.extent(data, d => d.year))
            .range([0+margin.left, width]);

        const y = d3.scaleLinear()
            .domain([0, d3.max(stackedData.flat(2))]) // Flatten stacked data
            .nice()
            .range([height, 0+margin.top]);

        // Area generator
        const area = d3.area()
            .x(d => x(d.data.year))
            .y0(d => y(d[0]))
            .y1(d => y(d[1]));

        // Line generator
        const line = d3.line()
            .x(d => x(d.data.year))
            .y(d => y(d[1]));

        // Draw stacked areas
        svg.selectAll("path.area")
            .data(stackedData)
            .join("path")
            .attr("class", "area")
            .attr("fill", d => figure3Meta[d.key].color)
            .attr("opacity", 0.9)
            .attr("d", area);

        stackedData.forEach((series, i) => {
            const solid = figure3Meta[series.key].solid;
            const dashed = figure3Meta[series.key].dashed;

            solid.forEach(solidSegs => {
                const seriesData = series.slice(solidSegs[0] - 1996, solidSegs[1] - 1996);
                const path = svg.append("path")
                    .datum(seriesData)
                    .attr("class", "line")
                    .attr("fill", "none")
                    .attr("stroke", "rgb(50,50,50)")
                    .attr("stroke-width", 1)
                    .attr("d", line);
            })

            dashed.forEach(dashedSegs => {
                const seriesData = series.slice(dashedSegs[0] - 1996, dashedSegs[1] - 1996 + 1);
                const path = svg.append("path")
                    .datum(seriesData)
                    .attr("class", "line")
                    .attr("fill", "none")
                    .attr("stroke", "rgb(50,50,50)")
                    .attr("stroke-width", 1)
                    .attr("stroke-dasharray", "5,5")
                    .attr("d", line);
            })

        });

        // Axes
        svg.append("g")
            .attr("transform", `translate(0,${height})`)
            .call(d3.axisBottom(x).tickFormat(d3.format("d")));

        svg.append("g")
            .attr("transform", `translate(${margin.left},0)`)
            .call(d3.axisLeft(y));

        // svg.append("g")
        //     .call(d3.axisRight(y));
    }

    let visibleIds = new Set(Object.keys(figure3Meta));
    let onlyVisibleCategory = null;

    const changeLegendBtnColor = (id) => {
        const item = figure3Meta[id];
        const legendBtn = document.getElementById(`figure_3_legend-btn-${id}`);
        const legendColor = legendBtn.querySelector('.figure_3_legend-color')
        legendColor.style.backgroundColor = item.color;
        const legendText = legendBtn.querySelector('.figure_3_legend-text')
        legendText.textContent = item.name;

        if (visibleIds.has(id)) {
            legendColor.style.backgroundColor = item.color
            legendText.style.color = "";
        } else {
            legendColor.style.backgroundColor = "rgba(0,0,0,0.1)";
            legendText.style.color = "rgba(0,0,0,0.2)";
        }
    }

    const changeLegendGrpHeaderColor = (grpId, grpName) => {
        const grpMeta = categories.find(x => x.name == grpName);
        const grpHeader = document.getElementById(`figure_3_legend-grp-header-${grpId}`);
        if (onlyVisibleCategory == grpName || onlyVisibleCategory == null) {
            grpHeader.style.backgroundColor = grpMeta.color;
            grpHeader.style.color = "white";
        } else {
            grpHeader.style.backgroundColor = "rgba(0,0,0,0.05)";
            grpHeader.style.color = "rgba(0,0,0,0.2)";
        }
    }

    const onlyShowGroup = (grpId) => {
        if (onlyVisibleCategory == grpId) {
            onlyVisibleCategory = null;
            visibleIds = new Set(Object.keys(figure3Meta));
        } else {
            onlyVisibleCategory = grpId;
            const grpLegendIds = Object.entries(figure3Meta).filter(([id, item]) => item.country == grpId).map(([id, _]) => id);
            visibleIds = new Set(grpLegendIds);
        }
        Object.keys(figure3Meta).forEach(item => {
            changeLegendBtnColor(item);
        })
        categories.forEach(item => changeLegendGrpHeaderColor(item.id, item.name))
        data = figure3Data.map(x => {
            const xx = Object.fromEntries(Object.entries(x).filter(([id, item]) => visibleIds.has(id)))
            return { year: x.year, ...xx };
        });
        keys = figure3Keys.filter(x => visibleIds.has(x));
    }

    const changeIdVisiblity = (ids) => {
        ids.forEach((x) => {
            if (visibleIds.has(x)) {
                visibleIds.delete(x);
            } else {
                visibleIds.add(x);
            }
        });

        data = figure3Data.map(x => {
            const xx = Object.fromEntries(Object.entries(x).filter(([id, item]) => visibleIds.has(id)))
            return { year: x.year, ...xx };
        });
        keys = figure3Keys.filter(x => visibleIds.has(x));

    }

    const legendDiv = document.getElementById("figure_3_legend")

    const drawLegends = (grpMeta, grpObj) => {

        const grpLegends = Object.entries(figure3Meta).filter(([_, item]) => {
            return item.country == grpMeta.name
        }).map(([id, item]) => ({ id, ...item }));

        grpLegends.forEach((item) => {
            const template = document.getElementById('figure_3_legend-btn-template');
            const clone = template.content.cloneNode(true);

            const legendColor = clone.querySelector('.figure_3_legend-color')
            legendColor.style.backgroundColor = item.color;
            const legendText = clone.querySelector('.figure_3_legend-text')
            legendText.textContent = item.name;

            const legendBtn = clone.querySelector('.figure_3_legend-btn')
            legendBtn.id = `figure_3_legend-btn-${item.id}`;
            legendBtn.onclick = (e) => {
                changeIdVisiblity([item.id])
                legendText.textContent = `${item.name}`
                if (visibleIds.has(item.id)) {
                    legendColor.style.backgroundColor = item.color
                    legendText.style.color = "";
                } else {
                    legendColor.style.backgroundColor = "rgba(0,0,0,0.1)";
                    legendText.style.color = "rgba(0,0,0,0.2)";
                }
                plot();
            };
            grpObj.appendChild(clone)
        })
    }

    categories.forEach((cat) => {
        const grpTemplate = document.getElementById('figure_3_legend-grp-template');
        const grpClone = grpTemplate.content.cloneNode(true);

        const grpHeader = grpClone.querySelector('.figure_3_legend-grp-header');
        grpHeader.id = `figure_3_legend-grp-header-${cat.id}`;
        grpHeader.style.backgroundColor = cat.color;
        grpHeader.textContent = cat.name;
        grpHeader.onclick = (e) => {
            onlyShowGroup(cat.name);
            plot();
        }

        const grpContent = grpClone.querySelector('.figure_3_legend-grp-content');
        drawLegends(cat, grpContent);
        legendDiv.appendChild(grpClone);
    })

    plot()
</script>