<div class="mt-5" style="overflow-x: auto;">
    <div class="figure1-plot-container mt-4" id="project_1_figure_2_container">

        <figure>
            <svg id="project_1_figure_2"></svg>
        </figure>
        <div style="min-width: 300px;">
            <div class="mb-2" style="text-align: center;">
                <select style="width:100%; border: solid 1px rgb(200,200,200);" id="yearSelect" class="form-select-sm"
                    aria-label="Default select example" onchange="onYearSelect()">
                    {{ range seq 2019 2023 }}
                    <option value="{{.}}">{{.}}</option>
                    {{ end }}
                </select>
            </div>
            <div id="figure_2_legend"></div>
        </div>
    </div>
</div>
<figcaption class="figure-caption" style="text-align: center;">
    Figure 2: A waffle chart showing the percentage of total storage amounts by project for the selected year
    (Publication Date: 01-Apr-25)
</figcaption>

<template id="figure_2_legend-grp-template">
    <div class="figure_2_legend-grp">
        <b>
            <div class="figure_2_legend-grp-header" style="font-size: 10px; color: white"></div>
        </b>
        <div class="figure_2_legend-grp-content"></div>
    </div>
</template>

<template id="figure_2_legend-btn-template">
    <div>
        <div class="figure_2_legend-btn" style="font-size: 10px;">
            <span class="figure_2_legend-color"></span>
            <span class="figure_2_legend-text"></span>
        </div>
    </div>
</template>

<script type="module">

    const allData = { "2019": [{ "id": "Jilin_Oilfield", "country": "China", "facility": "Jilin Oilfield", "year": 2019, "value": 1.5, "p": 0.05885584242329122, "n": 23, "pc": 0.7978723404255319, "nc": 319 }, { "id": "Karamay_Dunhua", "country": "China", "facility": "Karamay Dunhua", "year": 2019, "value": 0.1, "p": 0.003923722828219415, "n": 2, "pc": 0.05319148936170213, "nc": 21 }, { "id": "ShengLi__Oilfield", "country": "China", "facility": "ShengLi  Oilfield", "year": 2019, "value": 0.23, "p": 0.009024562504904654, "n": 4, "pc": 0.12234042553191489, "nc": 49 }, { "id": "Xinjiang_Ordos_Basin", "country": "China", "facility": "Xinjiang Ordos Basin", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Yanchang_Integrated_Demonstration", "country": "China", "facility": "Yanchang Integrated Demonstration", "year": 2019, "value": 0.05, "p": 0.0019618614141097075, "n": 2, "pc": 0.026595744680851064, "nc": 11 }, { "id": "Zhongyuan_Oilfield", "country": "China", "facility": "Zhongyuan Oilfield", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Tomakomai_CCS_Demonstration_Project", "country": "Japan", "facility": "Tomakomai CCS Demonstration Project", "year": 2019, "value": 0.065, "p": 0.0025504198383426197, "n": 1, "pc": 1.0, "nc": 400 }, { "id": "Qatar_LNG", "country": "Qatar", "facility": "Qatar LNG", "year": 2019, "value": 0.56, "p": 0.021972847838028723, "n": 9, "pc": 1.0, "nc": 400 }, { "id": "Uthmaniyah_Carbon_Dioxide_Enhanced_Oil_Recovery_(CO2-EOR)_Demonstration_Project", "country": "Saudi Arabia", "facility": "Uthmaniyah Carbon Dioxide Enhanced Oil Recovery (CO2-EOR) Demonstration Project", "year": 2019, "value": 0.8, "p": 0.03138978262575532, "n": 12, "pc": 1.0, "nc": 400 }, { "id": "ADNOC_Al_Reyadah", "country": "United Arab Emirates", "facility": "ADNOC Al Reyadah", "year": 2019, "value": 0.8, "p": 0.03138978262575532, "n": 12, "pc": 1.0, "nc": 400 }, { "id": "CO2_EOR_Project_Crotia", "country": "Croatia", "facility": "CO2 EOR Project Crotia", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0, "nc": 0 }, { "id": "Carbfix_Storage", "country": "Iceland", "facility": "Carbfix Storage", "year": 2019, "value": 0.01, "p": 0.0003923722828219415, "n": 1, "pc": 1.0, "nc": 400 }, { "id": "Sleipner", "country": "Norway", "facility": "Sleipner", "year": 2019, "value": 0.5, "p": 0.01961861414109707, "n": 8, "pc": 0.4166666666666667, "nc": 167 }, { "id": "Snohvit", "country": "Norway", "facility": "Snohvit", "year": 2019, "value": 0.7, "p": 0.0274660597975359, "n": 11, "pc": 0.5833333333333334, "nc": 233 }, { "id": "Alberta_Carbon_Trunk_Line_(ACTL)", "country": "Canada", "facility": "Alberta Carbon Trunk Line (ACTL)", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Aquistore", "country": "Canada", "facility": "Aquistore", "year": 2019, "value": 0.27, "p": 0.01059405163619242, "n": 4, "pc": 0.08009492732126966, "nc": 32 }, { "id": "Quest", "country": "Canada", "facility": "Quest", "year": 2019, "value": 1.128, "p": 0.04425959350231499, "n": 18, "pc": 0.3346188074755265, "nc": 134 }, { "id": "Weyburn-Midale", "country": "Canada", "facility": "Weyburn-Midale", "year": 2019, "value": 1.973, "p": 0.07741505140076906, "n": 31, "pc": 0.5852862652032038, "nc": 234 }, { "id": "30-30_Gas_Plant", "country": "USA", "facility": "30-30 Gas Plant", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Barnett_RDC_Well_No._1", "country": "USA", "facility": "Barnett RDC Well No. 1", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Blue_Flint_CO2_Storage_Project", "country": "USA", "facility": "Blue Flint CO2 Storage Project", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Campo_Viejo_Gas_Processing_Plant", "country": "USA", "facility": "Campo Viejo Gas Processing Plant", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Camrick_Unit", "country": "USA", "facility": "Camrick Unit", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Core_Energy__Otsego_County_EOR_Operations", "country": "USA", "facility": "Core Energy  Otsego County EOR Operations", "year": 2019, "value": 0.383, "p": 0.015027858432080357, "n": 6, "pc": 0.04034551774992099, "nc": 16 }, { "id": "Denver_Unit_/_Wasson_San_Andres_Field", "country": "USA", "facility": "Denver Unit / Wasson San Andres Field", "year": 2019, "value": 3.392, "p": 0.13309267833320254, "n": 53, "pc": 0.35731591699146736, "nc": 143 }, { "id": "Farnsworth_Unit_CO2_Flood", "country": "USA", "facility": "Farnsworth Unit CO2 Flood", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Hobbs_Field", "country": "USA", "facility": "Hobbs Field", "year": 2019, "value": 3.662, "p": 0.14368672996939497, "n": 57, "pc": 0.38575792689350047, "nc": 154 }, { "id": "Illinois_Industrial_Carbon_Capture_and_Sequestration_Project", "country": "USA", "facility": "Illinois Industrial Carbon Capture and Sequestration Project", "year": 2019, "value": 0.52, "p": 0.020403358706740957, "n": 8, "pc": 0.05477720425576741, "nc": 22 }, { "id": "North_Burbank_Unit", "country": "USA", "facility": "North Burbank Unit", "year": 2019, "value": 1.16, "p": 0.045515184807345205, "n": 18, "pc": 0.12219530180132727, "nc": 49 }, { "id": "Petra_Nova_West_Ranch", "country": "USA", "facility": "Petra Nova West Ranch", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Red_Hills_Gas_Processing_Plant", "country": "USA", "facility": "Red Hills Gas Processing Plant", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Red_Trail_Energy,_LLC", "country": "USA", "facility": "Red Trail Energy, LLC", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Seminole_East_Field_(SEF)", "country": "USA", "facility": "Seminole East Field (SEF)", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Seminole_San_Andres_Unit", "country": "USA", "facility": "Seminole San Andres Unit", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Shute_Creek", "country": "USA", "facility": "Shute Creek", "year": 2019, "value": 0.376, "p": 0.014753197834104998, "n": 6, "pc": 0.03960813230801643, "nc": 16 }, { "id": "West_Seminole_San_Andres_Unit", "country": "USA", "facility": "West Seminole San Andres Unit", "year": 2019, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Chevron_Gorgon", "country": "Australia", "facility": "Chevron Gorgon", "year": 2019, "value": 2.707, "p": 0.10621517695989954, "n": 42, "pc": 1.0, "nc": 400 }, { "id": "Petrobras_Santos_Basin_Pre-Salt_Oil_Field", "country": "Brazil", "facility": "Petrobras Santos Basin Pre-Salt Oil Field", "year": 2019, "value": 4.6, "p": 0.18049125009809305, "n": 72, "pc": 1.0, "nc": 400 }], "2020": [{ "id": "Jilin_Oilfield", "country": "China", "facility": "Jilin Oilfield", "year": 2020, "value": 1.9, "p": 0.07393859205354711, "n": 30, "pc": 0.8091993185689949, "nc": 324 }, { "id": "Karamay_Dunhua", "country": "China", "facility": "Karamay Dunhua", "year": 2020, "value": 0.1, "p": 0.0038915048449235322, "n": 1, "pc": 0.04258943781942079, "nc": 17 }, { "id": "ShengLi__Oilfield", "country": "China", "facility": "ShengLi  Oilfield", "year": 2020, "value": 0.298, "p": 0.011596684437872125, "n": 5, "pc": 0.12691652470187395, "nc": 51 }, { "id": "Xinjiang_Ordos_Basin", "country": "China", "facility": "Xinjiang Ordos Basin", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Yanchang_Integrated_Demonstration", "country": "China", "facility": "Yanchang Integrated Demonstration", "year": 2020, "value": 0.05, "p": 0.0019457524224617661, "n": 2, "pc": 0.021294718909710394, "nc": 8 }, { "id": "Zhongyuan_Oilfield", "country": "China", "facility": "Zhongyuan Oilfield", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Tomakomai_CCS_Demonstration_Project", "country": "Japan", "facility": "Tomakomai CCS Demonstration Project", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0, "nc": 0 }, { "id": "Qatar_LNG", "country": "Qatar", "facility": "Qatar LNG", "year": 2020, "value": 0.63, "p": 0.02451648052301825, "n": 10, "pc": 1.0, "nc": 400 }, { "id": "Uthmaniyah_Carbon_Dioxide_Enhanced_Oil_Recovery_(CO2-EOR)_Demonstration_Project", "country": "Saudi Arabia", "facility": "Uthmaniyah Carbon Dioxide Enhanced Oil Recovery (CO2-EOR) Demonstration Project", "year": 2020, "value": 0.8, "p": 0.031132038759388258, "n": 12, "pc": 1.0, "nc": 400 }, { "id": "ADNOC_Al_Reyadah", "country": "United Arab Emirates", "facility": "ADNOC Al Reyadah", "year": 2020, "value": 0.8, "p": 0.031132038759388258, "n": 12, "pc": 1.0, "nc": 400 }, { "id": "CO2_EOR_Project_Crotia", "country": "Croatia", "facility": "CO2 EOR Project Crotia", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0, "nc": 0 }, { "id": "Carbfix_Storage", "country": "Iceland", "facility": "Carbfix Storage", "year": 2020, "value": 0.012, "p": 0.00046698058139082386, "n": 1, "pc": 1.0, "nc": 400 }, { "id": "Sleipner", "country": "Norway", "facility": "Sleipner", "year": 2020, "value": 0.5, "p": 0.01945752422461766, "n": 8, "pc": 0.5555555555555556, "nc": 222 }, { "id": "Snohvit", "country": "Norway", "facility": "Snohvit", "year": 2020, "value": 0.4, "p": 0.015566019379694129, "n": 6, "pc": 0.4444444444444445, "nc": 178 }, { "id": "Alberta_Carbon_Trunk_Line_(ACTL)", "country": "Canada", "facility": "Alberta Carbon Trunk Line (ACTL)", "year": 2020, "value": 0.93, "p": 0.03619099505778885, "n": 14, "pc": 0.21965044874822864, "nc": 88 }, { "id": "Aquistore", "country": "Canada", "facility": "Aquistore", "year": 2020, "value": 0.37, "p": 0.014398567926217068, "n": 6, "pc": 0.08738781294284365, "nc": 35 }, { "id": "Quest", "country": "Canada", "facility": "Quest", "year": 2020, "value": 0.941, "p": 0.03661906059073043, "n": 15, "pc": 0.22224846480869154, "nc": 89 }, { "id": "Weyburn-Midale", "country": "Canada", "facility": "Weyburn-Midale", "year": 2020, "value": 1.993, "p": 0.077557691559326, "n": 31, "pc": 0.47071327350023623, "nc": 188 }, { "id": "30-30_Gas_Plant", "country": "USA", "facility": "30-30 Gas Plant", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Barnett_RDC_Well_No._1", "country": "USA", "facility": "Barnett RDC Well No. 1", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Blue_Flint_CO2_Storage_Project", "country": "USA", "facility": "Blue Flint CO2 Storage Project", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Campo_Viejo_Gas_Processing_Plant", "country": "USA", "facility": "Campo Viejo Gas Processing Plant", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Camrick_Unit", "country": "USA", "facility": "Camrick Unit", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Core_Energy__Otsego_County_EOR_Operations", "country": "USA", "facility": "Core Energy  Otsego County EOR Operations", "year": 2020, "value": 0.213, "p": 0.008288905319687123, "n": 3, "pc": 0.03131431931784769, "nc": 12 }, { "id": "Denver_Unit_/_Wasson_San_Andres_Field", "country": "USA", "facility": "Denver Unit / Wasson San Andres Field", "year": 2020, "value": 2.85, "p": 0.11090788808032066, "n": 44, "pc": 0.4189944134078213, "nc": 168 }, { "id": "Farnsworth_Unit_CO2_Flood", "country": "USA", "facility": "Farnsworth Unit CO2 Flood", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Hobbs_Field", "country": "USA", "facility": "Hobbs Field", "year": 2020, "value": 2.139, "p": 0.08323928863291434, "n": 33, "pc": 0.3144663334313437, "nc": 126 }, { "id": "Illinois_Industrial_Carbon_Capture_and_Sequestration_Project", "country": "USA", "facility": "Illinois Industrial Carbon Capture and Sequestration Project", "year": 2020, "value": 0.522, "p": 0.02031365529050084, "n": 8, "pc": 0.07674213466627464, "nc": 31 }, { "id": "North_Burbank_Unit", "country": "USA", "facility": "North Burbank Unit", "year": 2020, "value": 0.66, "p": 0.025683931976495312, "n": 10, "pc": 0.0970302852102323, "nc": 39 }, { "id": "Petra_Nova_West_Ranch", "country": "USA", "facility": "Petra Nova West Ranch", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Red_Hills_Gas_Processing_Plant", "country": "USA", "facility": "Red Hills Gas Processing Plant", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Red_Trail_Energy,_LLC", "country": "USA", "facility": "Red Trail Energy, LLC", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Seminole_East_Field_(SEF)", "country": "USA", "facility": "Seminole East Field (SEF)", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Seminole_San_Andres_Unit", "country": "USA", "facility": "Seminole San Andres Unit", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Shute_Creek", "country": "USA", "facility": "Shute Creek", "year": 2020, "value": 0.418, "p": 0.016266490251780362, "n": 6, "pc": 0.061452513966480445, "nc": 24 }, { "id": "West_Seminole_San_Andres_Unit", "country": "USA", "facility": "West Seminole San Andres Unit", "year": 2020, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Chevron_Gorgon", "country": "Australia", "facility": "Chevron Gorgon", "year": 2020, "value": 2.171, "p": 0.08448457018328988, "n": 34, "pc": 1.0, "nc": 400 }, { "id": "Petrobras_Santos_Basin_Pre-Salt_Oil_Field", "country": "Brazil", "facility": "Petrobras Santos Basin Pre-Salt Oil Field", "year": 2020, "value": 7.0, "p": 0.27240533914464726, "n": 109, "pc": 1.0, "nc": 400 }], "2021": [{ "id": "Jilin_Oilfield", "country": "China", "facility": "Jilin Oilfield", "year": 2021, "value": 2.0, "p": 0.0756744485224564, "n": 30, "pc": 0.8136696501220504, "nc": 326 }, { "id": "Karamay_Dunhua", "country": "China", "facility": "Karamay Dunhua", "year": 2021, "value": 0.1, "p": 0.00378372242612282, "n": 1, "pc": 0.04068348250610252, "nc": 16 }, { "id": "ShengLi__Oilfield", "country": "China", "facility": "ShengLi  Oilfield", "year": 2021, "value": 0.308, "p": 0.011653865072458285, "n": 5, "pc": 0.12530512611879577, "nc": 50 }, { "id": "Xinjiang_Ordos_Basin", "country": "China", "facility": "Xinjiang Ordos Basin", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Yanchang_Integrated_Demonstration", "country": "China", "facility": "Yanchang Integrated Demonstration", "year": 2021, "value": 0.05, "p": 0.00189186121306141, "n": 2, "pc": 0.02034174125305126, "nc": 8 }, { "id": "Zhongyuan_Oilfield", "country": "China", "facility": "Zhongyuan Oilfield", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Tomakomai_CCS_Demonstration_Project", "country": "Japan", "facility": "Tomakomai CCS Demonstration Project", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0, "nc": 0 }, { "id": "Qatar_LNG", "country": "Qatar", "facility": "Qatar LNG", "year": 2021, "value": 0.62, "p": 0.023459079041961484, "n": 9, "pc": 1.0, "nc": 400 }, { "id": "Uthmaniyah_Carbon_Dioxide_Enhanced_Oil_Recovery_(CO2-EOR)_Demonstration_Project", "country": "Saudi Arabia", "facility": "Uthmaniyah Carbon Dioxide Enhanced Oil Recovery (CO2-EOR) Demonstration Project", "year": 2021, "value": 0.8, "p": 0.03026977940898256, "n": 12, "pc": 1.0, "nc": 400 }, { "id": "ADNOC_Al_Reyadah", "country": "United Arab Emirates", "facility": "ADNOC Al Reyadah", "year": 2021, "value": 0.8, "p": 0.03026977940898256, "n": 12, "pc": 1.0, "nc": 400 }, { "id": "CO2_EOR_Project_Crotia", "country": "Croatia", "facility": "CO2 EOR Project Crotia", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0, "nc": 0 }, { "id": "Carbfix_Storage", "country": "Iceland", "facility": "Carbfix Storage", "year": 2021, "value": 0.012, "p": 0.0004540466911347384, "n": 1, "pc": 1.0, "nc": 400 }, { "id": "Sleipner", "country": "Norway", "facility": "Sleipner", "year": 2021, "value": 0.3, "p": 0.011351167278368459, "n": 4, "pc": 1.0, "nc": 400 }, { "id": "Snohvit", "country": "Norway", "facility": "Snohvit", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Alberta_Carbon_Trunk_Line_(ACTL)", "country": "Canada", "facility": "Alberta Carbon Trunk Line (ACTL)", "year": 2021, "value": 1.238, "p": 0.04684248363540051, "n": 19, "pc": 0.30455104551045514, "nc": 122 }, { "id": "Aquistore", "country": "Canada", "facility": "Aquistore", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Quest", "country": "Canada", "facility": "Quest", "year": 2021, "value": 1.055, "p": 0.039918271595595745, "n": 16, "pc": 0.2595325953259533, "nc": 104 }, { "id": "Weyburn-Midale", "country": "Canada", "facility": "Weyburn-Midale", "year": 2021, "value": 1.772, "p": 0.06704756139089636, "n": 27, "pc": 0.43591635916359167, "nc": 174 }, { "id": "30-30_Gas_Plant", "country": "USA", "facility": "30-30 Gas Plant", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Barnett_RDC_Well_No._1", "country": "USA", "facility": "Barnett RDC Well No. 1", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Blue_Flint_CO2_Storage_Project", "country": "USA", "facility": "Blue Flint CO2 Storage Project", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Campo_Viejo_Gas_Processing_Plant", "country": "USA", "facility": "Campo Viejo Gas Processing Plant", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Camrick_Unit", "country": "USA", "facility": "Camrick Unit", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Core_Energy__Otsego_County_EOR_Operations", "country": "USA", "facility": "Core Energy  Otsego County EOR Operations", "year": 2021, "value": 0.233, "p": 0.008816073252866171, "n": 3, "pc": 0.03315310187820148, "nc": 13 }, { "id": "Denver_Unit_/_Wasson_San_Andres_Field", "country": "USA", "facility": "Denver Unit / Wasson San Andres Field", "year": 2021, "value": 2.614, "p": 0.0989065042188505, "n": 39, "pc": 0.3719408081957883, "nc": 149 }, { "id": "Farnsworth_Unit_CO2_Flood", "country": "USA", "facility": "Farnsworth Unit CO2 Flood", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Hobbs_Field", "country": "USA", "facility": "Hobbs Field", "year": 2021, "value": 1.706, "p": 0.0645503045896553, "n": 26, "pc": 0.242743312464428, "nc": 97 }, { "id": "Illinois_Industrial_Carbon_Capture_and_Sequestration_Project", "country": "USA", "facility": "Illinois Industrial Carbon Capture and Sequestration Project", "year": 2021, "value": 0.52, "p": 0.019675356615838663, "n": 8, "pc": 0.07398975526465568, "nc": 30 }, { "id": "North_Burbank_Unit", "country": "USA", "facility": "North Burbank Unit", "year": 2021, "value": 0.714, "p": 0.02701577812251693, "n": 11, "pc": 0.10159362549800798, "nc": 41 }, { "id": "Petra_Nova_West_Ranch", "country": "USA", "facility": "Petra Nova West Ranch", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Red_Hills_Gas_Processing_Plant", "country": "USA", "facility": "Red Hills Gas Processing Plant", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Red_Trail_Energy,_LLC", "country": "USA", "facility": "Red Trail Energy, LLC", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Seminole_East_Field_(SEF)", "country": "USA", "facility": "Seminole East Field (SEF)", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Seminole_San_Andres_Unit", "country": "USA", "facility": "Seminole San Andres Unit", "year": 2021, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Shute_Creek", "country": "USA", "facility": "Shute Creek", "year": 2021, "value": 0.425, "p": 0.016080820311021985, "n": 6, "pc": 0.060472396129766647, "nc": 24 }, { "id": "West_Seminole_San_Andres_Unit", "country": "USA", "facility": "West Seminole San Andres Unit", "year": 2021, "value": 0.816, "p": 0.03087517499716221, "n": 12, "pc": 0.11610700056915196, "nc": 46 }, { "id": "Chevron_Gorgon", "country": "Australia", "facility": "Chevron Gorgon", "year": 2021, "value": 1.646, "p": 0.06228007113398161, "n": 25, "pc": 1.0, "nc": 400 }, { "id": "Petrobras_Santos_Basin_Pre-Salt_Oil_Field", "country": "Brazil", "facility": "Petrobras Santos Basin Pre-Salt Oil Field", "year": 2021, "value": 8.7, "p": 0.3291838510726853, "n": 132, "pc": 1.0, "nc": 400 }], "2022": [{ "id": "Jilin_Oilfield", "country": "China", "facility": "Jilin Oilfield", "year": 2022, "value": 2.77, "p": 0.0892052041736442, "n": 36, "pc": 0.7743919485602461, "nc": 310 }, { "id": "Karamay_Dunhua", "country": "China", "facility": "Karamay Dunhua", "year": 2022, "value": 0.1, "p": 0.0032204044828030402, "n": 1, "pc": 0.02795638803466592, "nc": 11 }, { "id": "ShengLi__Oilfield", "country": "China", "facility": "ShengLi  Oilfield", "year": 2022, "value": 0.657, "p": 0.021158057452015974, "n": 8, "pc": 0.1836734693877551, "nc": 73 }, { "id": "Xinjiang_Ordos_Basin", "country": "China", "facility": "Xinjiang Ordos Basin", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Yanchang_Integrated_Demonstration", "country": "China", "facility": "Yanchang Integrated Demonstration", "year": 2022, "value": 0.05, "p": 0.0016102022414015201, "n": 2, "pc": 0.01397819401733296, "nc": 6 }, { "id": "Zhongyuan_Oilfield", "country": "China", "facility": "Zhongyuan Oilfield", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Tomakomai_CCS_Demonstration_Project", "country": "Japan", "facility": "Tomakomai CCS Demonstration Project", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0, "nc": 0 }, { "id": "Qatar_LNG", "country": "Qatar", "facility": "Qatar LNG", "year": 2022, "value": 0.59, "p": 0.019000386448537937, "n": 7, "pc": 1.0, "nc": 400 }, { "id": "Uthmaniyah_Carbon_Dioxide_Enhanced_Oil_Recovery_(CO2-EOR)_Demonstration_Project", "country": "Saudi Arabia", "facility": "Uthmaniyah Carbon Dioxide Enhanced Oil Recovery (CO2-EOR) Demonstration Project", "year": 2022, "value": 0.8, "p": 0.025763235862424322, "n": 10, "pc": 1.0, "nc": 400 }, { "id": "ADNOC_Al_Reyadah", "country": "United Arab Emirates", "facility": "ADNOC Al Reyadah", "year": 2022, "value": 0.8, "p": 0.025763235862424322, "n": 10, "pc": 1.0, "nc": 400 }, { "id": "CO2_EOR_Project_Crotia", "country": "Croatia", "facility": "CO2 EOR Project Crotia", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0, "nc": 0 }, { "id": "Carbfix_Storage", "country": "Iceland", "facility": "Carbfix Storage", "year": 2022, "value": 0.012, "p": 0.00038644853793636484, "n": 1, "pc": 1.0, "nc": 400 }, { "id": "Sleipner", "country": "Norway", "facility": "Sleipner", "year": 2022, "value": 0.1, "p": 0.0032204044828030402, "n": 1, "pc": 0.2, "nc": 80 }, { "id": "Snohvit", "country": "Norway", "facility": "Snohvit", "year": 2022, "value": 0.4, "p": 0.012881617931212161, "n": 5, "pc": 0.8, "nc": 320 }, { "id": "Alberta_Carbon_Trunk_Line_(ACTL)", "country": "Canada", "facility": "Alberta Carbon Trunk Line (ACTL)", "year": 2022, "value": 1.033, "p": 0.0332667783073554, "n": 13, "pc": 0.2333935833709896, "nc": 93 }, { "id": "Aquistore", "country": "Canada", "facility": "Aquistore", "year": 2022, "value": 0.5, "p": 0.0161020224140152, "n": 6, "pc": 0.11296882060551287, "nc": 45 }, { "id": "Quest", "country": "Canada", "facility": "Quest", "year": 2022, "value": 0.971, "p": 0.03127012752801752, "n": 12, "pc": 0.219385449615906, "nc": 88 }, { "id": "Weyburn-Midale", "country": "Canada", "facility": "Weyburn-Midale", "year": 2022, "value": 1.922, "p": 0.06189617415947443, "n": 25, "pc": 0.43425214640759147, "nc": 174 }, { "id": "30-30_Gas_Plant", "country": "USA", "facility": "30-30 Gas Plant", "year": 2022, "value": 0.012, "p": 0.00038644853793636484, "n": 1, "pc": 0.00149458213974343, "nc": 2 }, { "id": "Barnett_RDC_Well_No._1", "country": "USA", "facility": "Barnett RDC Well No. 1", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Blue_Flint_CO2_Storage_Project", "country": "USA", "facility": "Blue Flint CO2 Storage Project", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Campo_Viejo_Gas_Processing_Plant", "country": "USA", "facility": "Campo Viejo Gas Processing Plant", "year": 2022, "value": 0.077, "p": 0.0024797114517583407, "n": 2, "pc": 0.00959023539668701, "nc": 4 }, { "id": "Camrick_Unit", "country": "USA", "facility": "Camrick Unit", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Core_Energy__Otsego_County_EOR_Operations", "country": "USA", "facility": "Core Energy  Otsego County EOR Operations", "year": 2022, "value": 0.311, "p": 0.010015457941517454, "n": 4, "pc": 0.03873458712168389, "nc": 15 }, { "id": "Denver_Unit_/_Wasson_San_Andres_Field", "country": "USA", "facility": "Denver Unit / Wasson San Andres Field", "year": 2022, "value": 2.997, "p": 0.09651552234960711, "n": 39, "pc": 0.37327188940092165, "nc": 149 }, { "id": "Farnsworth_Unit_CO2_Flood", "country": "USA", "facility": "Farnsworth Unit CO2 Flood", "year": 2022, "value": 0.092, "p": 0.002962772124178797, "n": 1, "pc": 0.011458463071366297, "nc": 5 }, { "id": "Hobbs_Field", "country": "USA", "facility": "Hobbs Field", "year": 2022, "value": 2.189, "p": 0.07049465412855856, "n": 28, "pc": 0.27263669199153073, "nc": 109 }, { "id": "Illinois_Industrial_Carbon_Capture_and_Sequestration_Project", "country": "USA", "facility": "Illinois Industrial Carbon Capture and Sequestration Project", "year": 2022, "value": 0.429, "p": 0.013815535231225041, "n": 5, "pc": 0.053431311495827624, "nc": 21 }, { "id": "North_Burbank_Unit", "country": "USA", "facility": "North Burbank Unit", "year": 2022, "value": 0.652, "p": 0.020997037227875822, "n": 8, "pc": 0.08120562959272637, "nc": 32 }, { "id": "Petra_Nova_West_Ranch", "country": "USA", "facility": "Petra Nova West Ranch", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Red_Hills_Gas_Processing_Plant", "country": "USA", "facility": "Red Hills Gas Processing Plant", "year": 2022, "value": 0.024, "p": 0.0007728970758727297, "n": 1, "pc": 0.00298916427948686, "nc": 1 }, { "id": "Red_Trail_Energy,_LLC", "country": "USA", "facility": "Red Trail Energy, LLC", "year": 2022, "value": 0.082, "p": 0.002640731675898493, "n": 1, "pc": 0.01021297795491344, "nc": 4 }, { "id": "Seminole_East_Field_(SEF)", "country": "USA", "facility": "Seminole East Field (SEF)", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Seminole_San_Andres_Unit", "country": "USA", "facility": "Seminole San Andres Unit", "year": 2022, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Shute_Creek", "country": "USA", "facility": "Shute Creek", "year": 2022, "value": 0.395, "p": 0.012720597707072009, "n": 5, "pc": 0.049196662099887906, "nc": 20 }, { "id": "West_Seminole_San_Andres_Unit", "country": "USA", "facility": "West Seminole San Andres Unit", "year": 2022, "value": 0.769, "p": 0.024764910472755378, "n": 10, "pc": 0.09577780545522481, "nc": 38 }, { "id": "Chevron_Gorgon", "country": "Australia", "facility": "Chevron Gorgon", "year": 2022, "value": 1.718, "p": 0.05532654901455623, "n": 22, "pc": 1.0, "nc": 400 }, { "id": "Petrobras_Santos_Basin_Pre-Salt_Oil_Field", "country": "Brazil", "facility": "Petrobras Santos Basin Pre-Salt Oil Field", "year": 2022, "value": 10.6, "p": 0.3413628751771222, "n": 136, "pc": 1.0, "nc": 400 }], "2023": [{ "id": "Jilin_Oilfield", "country": "China", "facility": "Jilin Oilfield", "year": 2023, "value": 1.59, "p": 0.04087088399352235, "n": 16, "pc": 0.6146115191341321, "nc": 246 }, { "id": "Karamay_Dunhua", "country": "China", "facility": "Karamay Dunhua", "year": 2023, "value": 0.1, "p": 0.0025704958486492046, "n": 1, "pc": 0.038654812524159254, "nc": 15 }, { "id": "ShengLi__Oilfield", "country": "China", "facility": "ShengLi  Oilfield", "year": 2023, "value": 0.847, "p": 0.02177209983805876, "n": 8, "pc": 0.32740626207962886, "nc": 131 }, { "id": "Xinjiang_Ordos_Basin", "country": "China", "facility": "Xinjiang Ordos Basin", "year": 2023, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Yanchang_Integrated_Demonstration", "country": "China", "facility": "Yanchang Integrated Demonstration", "year": 2023, "value": 0.05, "p": 0.0012852479243246023, "n": 1, "pc": 0.019327406262079627, "nc": 8 }, { "id": "Zhongyuan_Oilfield", "country": "China", "facility": "Zhongyuan Oilfield", "year": 2023, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Tomakomai_CCS_Demonstration_Project", "country": "Japan", "facility": "Tomakomai CCS Demonstration Project", "year": 2023, "value": 0.0, "p": 0.0, "n": 0, "pc": 0, "nc": 0 }, { "id": "Qatar_LNG", "country": "Qatar", "facility": "Qatar LNG", "year": 2023, "value": 0.68, "p": 0.017479371770814593, "n": 7, "pc": 1.0, "nc": 400 }, { "id": "Uthmaniyah_Carbon_Dioxide_Enhanced_Oil_Recovery_(CO2-EOR)_Demonstration_Project", "country": "Saudi Arabia", "facility": "Uthmaniyah Carbon Dioxide Enhanced Oil Recovery (CO2-EOR) Demonstration Project", "year": 2023, "value": 0.8, "p": 0.020563966789193637, "n": 8, "pc": 1.0, "nc": 400 }, { "id": "ADNOC_Al_Reyadah", "country": "United Arab Emirates", "facility": "ADNOC Al Reyadah", "year": 2023, "value": 0.8, "p": 0.020563966789193637, "n": 8, "pc": 1.0, "nc": 400 }, { "id": "CO2_EOR_Project_Crotia", "country": "Croatia", "facility": "CO2 EOR Project Crotia", "year": 2023, "value": 0.0, "p": 0.0, "n": 0, "pc": 0, "nc": 0 }, { "id": "Carbfix_Storage", "country": "Iceland", "facility": "Carbfix Storage", "year": 2023, "value": 0.012, "p": 0.00030845950183790453, "n": 1, "pc": 1.0, "nc": 400 }, { "id": "Sleipner", "country": "Norway", "facility": "Sleipner", "year": 2023, "value": 0.1, "p": 0.0025704958486492046, "n": 1, "pc": 0.12500000000000003, "nc": 50 }, { "id": "Snohvit", "country": "Norway", "facility": "Snohvit", "year": 2023, "value": 0.7, "p": 0.01799347094054443, "n": 7, "pc": 0.875, "nc": 350 }, { "id": "Alberta_Carbon_Trunk_Line_(ACTL)", "country": "Canada", "facility": "Alberta Carbon Trunk Line (ACTL)", "year": 2023, "value": 1.476, "p": 0.03794051872606226, "n": 15, "pc": 0.5954013715207744, "nc": 238 }, { "id": "Aquistore", "country": "Canada", "facility": "Aquistore", "year": 2023, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "Quest", "country": "Canada", "facility": "Quest", "year": 2023, "value": 1.003, "p": 0.02578207336195152, "n": 10, "pc": 0.40459862847922545, "nc": 162 }, { "id": "Weyburn-Midale", "country": "Canada", "facility": "Weyburn-Midale", "year": 2023, "value": 0.0, "p": 0.0, "n": 0, "pc": 0.0, "nc": 0 }, { "id": "30-30_Gas_Plant", "country": "USA", "facility": "30-30 Gas Plant", "year": 2023, "value": 0.01, "p": 0.00025704958486492046, "n": 1, "pc": 0.0006191567085629373, "nc": 1 }, { "id": "Barnett_RDC_Well_No._1", "country": "USA", "facility": "Barnett RDC Well No. 1", "year": 2023, "value": 0.008, "p": 0.00020563966789193636, "n": 1, "pc": 0.0004953253668503498, "nc": 1 }, { "id": "Blue_Flint_CO2_Storage_Project", "country": "USA", "facility": "Blue Flint CO2 Storage Project", "year": 2023, "value": 0.03, "p": 0.0007711487545947613, "n": 1, "pc": 0.0018574701256888117, "nc": 1 }, { "id": "Campo_Viejo_Gas_Processing_Plant", "country": "USA", "facility": "Campo Viejo Gas Processing Plant", "year": 2023, "value": 0.01, "p": 0.00025704958486492046, "n": 1, "pc": 0.0006191567085629373, "nc": 1 }, { "id": "Camrick_Unit", "country": "USA", "facility": "Camrick Unit", "year": 2023, "value": 0.034, "p": 0.0008739685885407296, "n": 1, "pc": 0.0021051328091139868, "nc": 2 }, { "id": "Core_Energy__Otsego_County_EOR_Operations", "country": "USA", "facility": "Core Energy  Otsego County EOR Operations", "year": 2023, "value": 0.261, "p": 0.006708994164974424, "n": 2, "pc": 0.016159990093492664, "nc": 6 }, { "id": "Denver_Unit_/_Wasson_San_Andres_Field", "country": "USA", "facility": "Denver Unit / Wasson San Andres Field", "year": 2023, "value": 3.67, "p": 0.09433719764542581, "n": 38, "pc": 0.22723051204259798, "nc": 91 }, { "id": "Farnsworth_Unit_CO2_Flood", "country": "USA", "facility": "Farnsworth Unit CO2 Flood", "year": 2023, "value": 0.07, "p": 0.0017993470940544432, "n": 2, "pc": 0.004334096959940561, "nc": 1 }, { "id": "Hobbs_Field", "country": "USA", "facility": "Hobbs Field", "year": 2023, "value": 5.198, "p": 0.13361437421278566, "n": 53, "pc": 0.3218376571110148, "nc": 128 }, { "id": "Illinois_Industrial_Carbon_Capture_and_Sequestration_Project", "country": "USA", "facility": "Illinois Industrial Carbon Capture and Sequestration Project", "year": 2023, "value": 0.544, "p": 0.013983497416651674, "n": 5, "pc": 0.03368212494582379, "nc": 13 }, { "id": "North_Burbank_Unit", "country": "USA", "facility": "North Burbank Unit", "year": 2023, "value": 0.631, "p": 0.01621982880497648, "n": 6, "pc": 0.039068788310321345, "nc": 15 }, { "id": "Petra_Nova_West_Ranch", "country": "USA", "facility": "Petra Nova West Ranch", "year": 2023, "value": 0.36, "p": 0.009253785055137137, "n": 3, "pc": 0.02228964150826574, "nc": 9 }, { "id": "Red_Hills_Gas_Processing_Plant", "country": "USA", "facility": "Red Hills Gas Processing Plant", "year": 2023, "value": 0.022, "p": 0.000565509086702825, "n": 1, "pc": 0.001362144758838462, "nc": 1 }, { "id": "Red_Trail_Energy,_LLC", "country": "USA", "facility": "Red Trail Energy, LLC", "year": 2023, "value": 0.166, "p": 0.00426702310875768, "n": 1, "pc": 0.010278001362144759, "nc": 4 }, { "id": "Seminole_East_Field_(SEF)", "country": "USA", "facility": "Seminole East Field (SEF)", "year": 2023, "value": 0.033, "p": 0.0008482636300542375, "n": 1, "pc": 0.002043217138257693, "nc": 1 }, { "id": "Seminole_San_Andres_Unit", "country": "USA", "facility": "Seminole San Andres Unit", "year": 2023, "value": 3.933, "p": 0.10109760172737321, "n": 40, "pc": 0.2435143334778032, "nc": 97 }, { "id": "Shute_Creek", "country": "USA", "facility": "Shute Creek", "year": 2023, "value": 0.435, "p": 0.011181656941624039, "n": 4, "pc": 0.02693331682248777, "nc": 10 }, { "id": "West_Seminole_San_Andres_Unit", "country": "USA", "facility": "West Seminole San Andres Unit", "year": 2023, "value": 0.736, "p": 0.018918849446058143, "n": 7, "pc": 0.04556993375023218, "nc": 18 }, { "id": "Chevron_Gorgon", "country": "Australia", "facility": "Chevron Gorgon", "year": 2023, "value": 1.594, "p": 0.04097370382746832, "n": 16, "pc": 1.0, "nc": 400 }, { "id": "Petrobras_Santos_Basin_Pre-Salt_Oil_Field", "country": "Brazil", "facility": "Petrobras Santos Basin Pre-Salt Oil Field", "year": 2023, "value": 13.0, "p": 0.33416446032439656, "n": 133, "pc": 1.0, "nc": 400 }] };
    const figure2Meta = [{ "id": "Jilin_Oilfield", "name": "Jilin Oilfield", "color": "#be3746", "category": 11, "country": "China" }, { "id": "Karamay_Dunhua", "name": "Karamay Dunhua", "color": "#d24b32", "category": 11, "country": "China" }, { "id": "ShengLi__Oilfield", "name": "ShengLi  Oilfield", "color": "#eb463c", "category": 11, "country": "China" }, { "id": "Xinjiang_Ordos_Basin", "name": "Xinjiang Ordos Basin", "color": "#fee5d8", "category": 11, "country": "China" }, { "id": "Yanchang_Integrated_Demonstration", "name": "Yanchang Integrated Demonstration", "color": "#dc5a50", "category": 11, "country": "China" }, { "id": "Zhongyuan_Oilfield", "name": "Zhongyuan Oilfield", "color": "#fff5f0", "category": 11, "country": "China" }, { "id": "Tomakomai_CCS_Demonstration_Project", "name": "Tomakomai CCS Demonstration Project", "color": "#fb9a99", "category": 10, "country": "Japan" }, { "id": "Qatar_LNG", "name": "Qatar LNG", "color": "#d27832", "category": 9, "country": "Qatar" }, { "id": "Uthmaniyah_Carbon_Dioxide_Enhanced_Oil_Recovery_(CO2-EOR)_Demonstration_Project", "name": "Uthmaniyah Carbon Dioxide Enhanced Oil Recovery (CO2-EOR) Demonstration Project", "color": "#A0643C", "category": 8, "country": "Saudi Arabia" }, { "id": "ADNOC_Al_Reyadah", "name": "ADNOC Al Reyadah", "color": "#f0b432", "category": 7, "country": "United Arab Emirates" }, { "id": "CO2_EOR_Project_Crotia", "name": "CO2 EOR Project Crotia", "color": "#92c5de", "category": 6, "country": "Croatia" }, { "id": "Carbfix_Storage", "name": "Carbfix Storage", "color": "#1c9099", "category": 5, "country": "Iceland" }, { "id": "Sleipner", "name": "Sleipner", "color": "#0080ff", "category": 4, "country": "Norway" }, { "id": "Snohvit", "name": "Snohvit", "color": "#0066cc", "category": 4, "country": "Norway" }, { "id": "Alberta_Carbon_Trunk_Line_(ACTL)", "name": "Alberta Carbon Trunk Line (ACTL)", "color": "#dadaeb", "category": 3, "country": "Canada" }, { "id": "Aquistore", "name": "Aquistore", "color": "#9e9ac8", "category": 3, "country": "Canada" }, { "id": "Quest", "name": "Quest", "color": "#bcbddc", "category": 3, "country": "Canada" }, { "id": "Weyburn-Midale", "name": "Weyburn-Midale", "color": "#807dba", "category": 3, "country": "Canada" }, { "id": "30-30_Gas_Plant", "name": "30-30 Gas Plant", "color": "#dda0dd", "category": 2, "country": "USA" }, { "id": "Barnett_RDC_Well_No._1", "name": "Barnett RDC Well No. 1", "color": "#da70d6", "category": 2, "country": "USA" }, { "id": "Blue_Flint_CO2_Storage_Project", "name": "Blue Flint CO2 Storage Project", "color": "#c71585", "category": 2, "country": "USA" }, { "id": "Campo_Viejo_Gas_Processing_Plant", "name": "Campo Viejo Gas Processing Plant", "color": "#ff00ff", "category": 2, "country": "USA" }, { "id": "Camrick_Unit", "name": "Camrick Unit", "color": "#cc00cc", "category": 2, "country": "USA" }, { "id": "Core_Energy__Otsego_County_EOR_Operations", "name": "Core Energy  Otsego County EOR Operations", "color": "#a020f0", "category": 2, "country": "USA" }, { "id": "Denver_Unit_/_Wasson_San_Andres_Field", "name": "Denver Unit / Wasson San Andres Field", "color": "#8a2be2", "category": 2, "country": "USA" }, { "id": "Farnsworth_Unit_CO2_Flood", "name": "Farnsworth Unit CO2 Flood", "color": "#bebada", "category": 2, "country": "USA" }, { "id": "Hobbs_Field", "name": "Hobbs Field", "color": "#913d88", "category": 2, "country": "USA" }, { "id": "Illinois_Industrial_Carbon_Capture_and_Sequestration_Project", "name": "Illinois Industrial Carbon Capture and Sequestration Project", "color": "#ee82ee", "category": 2, "country": "USA" }, { "id": "North_Burbank_Unit", "name": "North Burbank Unit", "color": "#9400d3", "category": 2, "country": "USA" }, { "id": "Petra_Nova_West_Ranch", "name": "Petra Nova West Ranch", "color": "#702963", "category": 2, "country": "USA" }, { "id": "Red_Hills_Gas_Processing_Plant", "name": "Red Hills Gas Processing Plant", "color": "#8c3cc8", "category": 2, "country": "USA" }, { "id": "Red_Trail_Energy,_LLC", "name": "Red Trail Energy, LLC", "color": "#aa2db4", "category": 2, "country": "USA" }, { "id": "Seminole_East_Field_(SEF)", "name": "Seminole East Field (SEF)", "color": "#b446dc", "category": 2, "country": "USA" }, { "id": "Seminole_San_Andres_Unit", "name": "Seminole San Andres Unit", "color": "#7832a0", "category": 2, "country": "USA" }, { "id": "Shute_Creek", "name": "Shute Creek", "color": "#d8bfd8", "category": 2, "country": "USA" }, { "id": "West_Seminole_San_Andres_Unit", "name": "West Seminole San Andres Unit", "color": "#c864ff", "category": 2, "country": "USA" }, { "id": "Chevron_Gorgon", "name": "Chevron Gorgon", "color": "#636363", "category": 1, "country": "Australia" }, { "id": "Petrobras_Santos_Basin_Pre-Salt_Oil_Field", "name": "Petrobras Santos Basin Pre-Salt Oil Field", "color": "#32a050", "category": 0, "country": "Brazil" }];
    const categories = [
        { 'id': 0, 'name': 'Brazil', 'color': 'rgb(50, 160, 80)' },
        { 'id': 1, 'name': 'Australia', 'color': 'rgb(99,99,99)' },
        { 'id': 2, 'name': 'USA', 'color': 'rgb(204, 0, 204)' },
        { 'id': 3, 'name': 'Canada', 'color': 'rgb(128, 0, 128)' },
        { 'id': 4, 'name': 'Norway', 'color': 'rgb(0, 128, 255)' },
        { 'id': 5, 'name': 'Iceland', 'color': '#1c9099' },
        { 'id': 6, 'name': 'Croatia', 'color': '#92c5de' },
        { 'id': 7, 'name': 'United Arab Emirates', 'color': 'rgb(240, 180, 50)' },
        { 'id': 8, 'name': 'Saudi Arabia', 'color': 'rgb(160, 100, 60)' },
        { 'id': 9, 'name': 'Qatar', 'color': 'rgb(210, 120, 50)' },
        { 'id': 10, 'name': 'Japan', 'color': '#fb9a99' },
        { 'id': 11, 'name': 'China', 'color': 'rgb(239,59,44)' }
    ];
    const color = (id) => {
        return figure2Meta.find(x => x.id == id).color
    };

    let currentYear = 2023;
    let data = allData[currentYear];
    const nSquares = 20;

    const tooltip = d3.select("#project_1_figure_2_container").append("div")
        .style("position", "absolute")
        .style("background", "rgba(255,255,255,0.9)")
        .style("border", "1px solid black")
        .style("padding", "5px")
        .style("border-radius", "5px")
        .style("visibility", "hidden")
        .style("font-size", "12px");

    const buildToolTipDiv = (meta) => {
        const { facility, year, country, p, pc } = meta;

        return `
        <div><b>Facility:</b></div>
    <div id="itemId">${facility}</div>

    <div><b>Country:</b></div>
    <div id="country-value">${country}</div>

    <div><b id="year-title">${year}:</b></div>
    <div id="year-value">${onlyVisibleCategory ? pc.toFixed(4) * 100 : p.toFixed(4) * 100}%</div>
        `
    }

    const drawChart = (waffles) => {
        const chartData = data;
        const margin = { top: 20, right: 20, bottom: 20, left: 20 };
        const options = {
            shape: "rect",
            style: "whole"
        }
        const isRect = options.shape === "rect";
        const whole = options.style === "whole";
        const width = 1000 - margin.left - margin.right;
        const height = 860 - margin.top - margin.bottom;
        const waffleSize = Math.min(width, height);

        const sequence = (length) => Array.apply(null, { length: length }).map((d, i) => i);
        const scale = d3.scaleBand()
            .domain(sequence(nSquares))
            .range([0, waffleSize])
            .padding(0.1)

        const svg = d3.select("#project_1_figure_2")
            .attr("width", width + margin.left + margin.right)
            .attr("height", height + margin.top + margin.bottom)
        // .attr("transform", `translate(${margin.left},${margin.top})`);
        // .style("cursor", "default")
        // .attr("viewBox", [0, 0, width, height])


        const g = svg.selectAll(".waffle")
            .data(waffles)
            .join("g")
            .attr("class", "waffle")
            .attr("transform", `translate(${(width + margin.left + margin.right - waffleSize) / 2},0)`);

        const cellSize = scale.bandwidth();
        const half = cellSize / 2;
        const cells = g.append("g")
            .selectAll(options.shape)
            .data(d => d)
            .join(options.shape)
            .attr("fill", (d) => {
                return d.index == -1 ? "rgb(240,240,240)" : color(d.meta.id)
            }).on("mouseover", (event, d) => {
                const htmlContent = buildToolTipDiv(d.meta);
                tooltip.style("visibility", "visible")
                    .html(htmlContent);
            })
            .on("mousemove", (event) => {
                tooltip.style("top", (event.pageY - 10) + "px")
                    .style("left", (event.pageX + 10) + "px");
            })
            .on("mouseout", () => {
                tooltip.style("visibility", "hidden");
            });
        // .attr("stroke", "rgba(156,156,156,1)")
        // .attr("stroke-width", 1);
        cells.attr("x", d => scale(d.x))
            .attr("y", d => whole ? 0 : scale(d.y))
            .attr("width", cellSize).attr("height", cellSize)

        cells.transition()
            .attr("y", d => scale(d.y) + (isRect ? 0 : half));

        return svg.node();
    }

    const makeWaffle = () => {
        const chartData = data;
        d3.select("#project_1_figure_2").selectAll("*").remove();
        const waffles = [];
        const max = chartData.length;

        let index = 0, curr = 1,
            accu = Math.round(onlyVisibleCategory == null ? chartData[0].n : chartData[0].nc), waffle = [];

        for (let y = nSquares - 1; y >= 0; y--)
            for (let x = 0; x < nSquares; x++) {
                if (curr > accu && index < max) {
                    let r = onlyVisibleCategory == null ? Math.round(chartData[++index].n) : Math.round(chartData[++index].nc);
                    while (r === 0 && index < max) {
                        r = onlyVisibleCategory == null ? Math.round(chartData[++index].n) : Math.round(chartData[++index].nc);
                    }
                    accu += r;
                }
                waffle.push({ x, y, index, meta: chartData[index] });
                curr++;
            }
        waffles.push(waffle);
        return waffles;
    }

    const makeChart = () => {
        try {
            const waffles = makeWaffle()
            drawChart(waffles)
        } catch (error) {
            const waffles = []
            for (let y = nSquares - 1; y >= 0; y--) {
                for (let x = 0; x < nSquares; x++) {
                    waffles.push({ x, y, index: -1, meta: {} });
                }
            }
            drawChart([waffles])
        }
    }

    let visibleIds = new Set(figure2Meta.map(item => item.id));
    let colorfulIds = new Set(figure2Meta.map(item => item.id));
    let onlyVisibleCategory = null;

    const changeLegendBtnColor = (id) => {
        const item = figure2Meta.find(x => x.id == id);
        const legendBtn = document.getElementById(`figure_2_legend-btn-${item.id}`);
        const legendColor = legendBtn.querySelector('.figure_2_legend-color')
        legendColor.style.backgroundColor = item.color;
        const legendText = legendBtn.querySelector('.figure_2_legend-text')

        if (visibleIds.has(id)) {
            if (onlyVisibleCategory == null) {
                legendText.textContent = `${item.name} (${(data.find(x => x.id == item.id).p * 100).toFixed(2)}%)`;
            } else {
                legendText.textContent = `${item.name} (${(data.find(x => x.id == item.id).pc * 100).toFixed(2)}%)`;
            }
            legendColor.style.backgroundColor = item.color
            legendText.style.color = "";
        } else {
            legendText.textContent = item.name;
            legendColor.style.backgroundColor = "rgba(0,0,0,0.1)";
            legendText.style.color = "rgba(0,0,0,0.2)";
        }
    }

    const changeLegendGrpHeaderColor = (grpId, grpName) => {
        const grpMeta = categories.find(x => x.id == grpId);
        const grpHeader = document.getElementById(`figure_2_legend-grp-header-${grpId}`);
        if (onlyVisibleCategory == grpName || onlyVisibleCategory == null) {
            grpHeader.style.backgroundColor = grpMeta.color;
            grpHeader.style.color = "white";
        } else {
            grpHeader.style.backgroundColor = "rgba(0,0,0,0.05)";
            grpHeader.style.color = "rgba(0,0,0,0.2)";
        }
    }

    const onlyShowGroup = (grpId, grpName) => {
        if (onlyVisibleCategory == grpName) {
            onlyVisibleCategory = null;
            visibleIds = new Set(figure2Meta.map(item => item.id));
            data = allData[currentYear]
        } else {
            onlyVisibleCategory = grpName;
            const grpLegendIds = figure2Meta.filter(item => item.country == grpName).map(item => item.id);
            visibleIds = new Set(grpLegendIds);
            data = allData[currentYear].filter(x => x.country == onlyVisibleCategory);
        }
        figure2Meta.forEach(item => {
            changeLegendBtnColor(item.id);
        })
        categories.forEach(item => changeLegendGrpHeaderColor(item.id, item.name));
    }

    const changeIdColorful = (ids) => {
        ids.forEach((x) => {
            if (colorfulIds.has(x)) {
                colorfulIds.delete(x);
            } else {
                colorfulIds.add(x);
            }
        });

        figure2Meta.forEach(item => {
            changeLegendBtnColor(item.id);
        })
    }

    const legendDiv = document.getElementById("figure_2_legend")

    const drawLegends = (grpMeta, grpObj) => {

        const grpLegends = figure2Meta.filter((item) => {
            return item.category == grpMeta.id
        });

        grpLegends.forEach((item) => {
            const template = document.getElementById('figure_2_legend-btn-template');
            const clone = template.content.cloneNode(true);

            const legendColor = clone.querySelector('.figure_2_legend-color')
            legendColor.style.backgroundColor = item.color;
            const legendText = clone.querySelector('.figure_2_legend-text')
            legendText.textContent = `${item.name} (${(data.find(x => x.id == item.id).p * 100).toFixed(2)}%)`;

            const legendBtn = clone.querySelector('.figure_2_legend-btn')
            legendBtn.id = `figure_2_legend-btn-${item.id}`;
            // legendBtn.onclick = (e) => {
            //     changeIdColorful([item.id])
            //     legendText.textContent = `${item.name}`
            //     if (colorfulIds.has(item.id)) {
            //         legendColor.style.backgroundColor = item.color
            //         legendText.style.color = "";
            //     } else {
            //         legendColor.style.backgroundColor = "rgba(0,0,0,0.1)";
            //         legendText.style.color = "rgba(0,0,0,0.2)";
            //     }
            // };

            grpObj.appendChild(clone)
        })
    }

    categories.forEach((cat) => {
        const grpTemplate = document.getElementById('figure_2_legend-grp-template');
        const grpClone = grpTemplate.content.cloneNode(true);

        const grpHeader = grpClone.querySelector('.figure_2_legend-grp-header');
        grpHeader.id = `figure_2_legend-grp-header-${cat.id}`;
        grpHeader.style.backgroundColor = cat.color;
        grpHeader.textContent = cat.name;
        grpHeader.onclick = (e) => {
            onlyShowGroup(cat.id, cat.name);
            makeChart()
        }

        const grpContent = grpClone.querySelector('.figure_2_legend-grp-content');
        drawLegends(cat, grpContent);
        legendDiv.appendChild(grpClone);
    })

    window.onYearSelect = () => {
        const selectElement = document.getElementById("yearSelect");
        currentYear = selectElement.value;
        if (onlyVisibleCategory) {
            data = allData[currentYear].filter(x => x.country == onlyVisibleCategory);
        } else {
            data = allData[currentYear]
        }
        makeChart()
    }

    window.onload = () => {
        document.getElementById("yearSelect").value = currentYear;
        makeChart()
    }

</script>